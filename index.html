<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle for Virtue - Enhanced Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&family=Cinzel:wght@600;700&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Crimson Text', serif; background: linear-gradient(135deg, #1a1a2e 0%, #2d1b4e 100%); color: #fff; overflow: hidden; }
        
        /* Enhanced sprite system with better graphics */
        .sprite { position: relative; width: 100px; height: 120px; }
        .sprite-guardian { width: 100px; height: 120px; position: relative; }
        .sprite-guardian::before { content: '‚òÉÔ∏è'; font-size: 80px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); filter: drop-shadow(0 0 20px rgba(135, 206, 235, 0.9)); }
        .sprite-angel { width: 100px; height: 120px; position: relative; }
        .sprite-angel::before { content: 'üòá'; font-size: 80px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.9)); }
        .sprite-angel::after { content: ''; position: absolute; top: -5px; left: 50%; transform: translateX(-50%); width: 70px; height: 15px; border: 3px solid #FFD700; border-radius: 50%; box-shadow: 0 0 30px #FFD700, inset 0 0 15px #FFD700; animation: haloGlow 2s ease-in-out infinite; }
        @keyframes haloGlow { 0%, 100% { box-shadow: 0 0 30px #FFD700, inset 0 0 15px #FFD700; opacity: 0.8; } 50% { box-shadow: 0 0 50px #FFD700, inset 0 0 25px #FFD700; opacity: 1; } }
        .sprite-enemy { width: 100px; height: 100px; position: relative; font-size: 80px; display: flex; align-items: center; justify-content: center; filter: drop-shadow(0 0 30px rgba(255, 0, 0, 1)); }
        
        /* Saint Modal with beautiful design */
        #saintModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.95); display: none; align-items: center; justify-content: center; z-index: 1700; padding: 40px; }
        #saintModal.active { display: flex; animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .saint-content { max-width: 800px; background: linear-gradient(135deg, rgba(15, 12, 41, 0.98), rgba(48, 43, 99, 0.98)); padding: 50px; border: 5px solid #FFD700; border-radius: 20px; box-shadow: 0 0 70px rgba(255, 215, 0, 0.9); text-align: center; position: relative; overflow: hidden; }
        .saint-content::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255, 215, 0, 0.15) 0%, transparent 70%); animation: saintGlow 4s ease-in-out infinite; }
        @keyframes saintGlow { 0%, 100% { transform: rotate(0deg); } 50% { transform: rotate(180deg); } }
        .saint-image-container { position: relative; width: 250px; height: 250px; margin: 0 auto 30px; border-radius: 50%; border: 5px solid #FFD700; overflow: hidden; box-shadow: 0 0 50px rgba(255, 215, 0, 0.8), inset 0 0 40px rgba(255, 215, 0, 0.3); background: linear-gradient(135deg, #2c1810 0%, #1a0f0a 100%); }
        .saint-image { width: 100%; height: 100%; object-fit: cover; font-size: 150px; display: flex; align-items: center; justify-content: center; background: radial-gradient(circle, rgba(255, 215, 0, 0.25) 0%, transparent 70%); }
        .saint-halo { position: absolute; top: -20px; left: 50%; transform: translateX(-50%); width: 200px; height: 40px; border: 5px solid #FFD700; border-radius: 50%; box-shadow: 0 0 50px #FFD700, inset 0 0 30px #FFD700; animation: haloFloat 3s ease-in-out infinite; }
        @keyframes haloFloat { 0%, 100% { transform: translateX(-50%) translateY(0); } 50% { transform: translateX(-50%) translateY(-10px); } }
        .saint-title { font-family: 'Cinzel', serif; font-size: 32px; color: #FFD700; margin-bottom: 20px; text-shadow: 3px 3px 0 #000, 0 0 40px #FFD700; position: relative; z-index: 1; }
        .saint-virtue { font-size: 18px; color: #87CEEB; margin-bottom: 25px; font-style: italic; position: relative; z-index: 1; }
        .saint-quote { font-size: 20px; line-height: 1.9; color: #f0f0f0; margin-bottom: 25px; text-align: justify; font-style: italic; padding: 30px; background: rgba(0, 0, 0, 0.6); border-left: 5px solid #FFD700; border-right: 5px solid #FFD700; position: relative; z-index: 1; border-radius: 10px; }
        .saint-quote::before { content: '"'; font-size: 70px; color: #FFD700; position: absolute; left: 10px; top: -15px; opacity: 0.6; font-family: Georgia, serif; }
        .saint-quote::after { content: '"'; font-size: 70px; color: #FFD700; position: absolute; right: 10px; bottom: -45px; opacity: 0.6; font-family: Georgia, serif; }
        .saint-prayer { font-family: 'Cinzel', serif; font-size: 26px; color: #FFD700; margin: 35px 0; text-shadow: 2px 2px 0 #000, 0 0 20px #FFD700; position: relative; z-index: 1; animation: prayerPulse 2s ease-in-out infinite; font-weight: 600; }
        @keyframes prayerPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.08); } }
        
        /* Garden of Eden Modal with stunning visuals */
        #gardenModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1a4d2e 0%, #2d5f3f 50%, #4a7c59 100%); display: none; align-items: center; justify-content: center; z-index: 1800; padding: 40px; overflow: hidden; }
        #gardenModal.active { display: flex; animation: gardenReveal 2s ease-out; }
        @keyframes gardenReveal { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .garden-background { position: absolute; width: 100%; height: 100%; background: radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.25) 0%, transparent 50%), radial-gradient(circle at 80% 70%, rgba(135, 206, 235, 0.25) 0%, transparent 50%), linear-gradient(180deg, #87CEEB 0%, #98D8C8 50%, #5D8B6B 100%); animation: gardenBreeze 10s ease-in-out infinite; }
        @keyframes gardenBreeze { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }
        .garden-flowers { position: absolute; width: 100%; height: 100%; pointer-events: none; }
        .flower { position: absolute; font-size: 45px; animation: flowerSway 3s ease-in-out infinite; filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.6)); }
        @keyframes flowerSway { 0%, 100% { transform: rotate(-8deg); } 50% { transform: rotate(8deg); } }
        .paradise-sun { position: absolute; top: 50px; right: 100px; width: 180px; height: 180px; background: radial-gradient(circle, #FFD700 0%, #FFA500 100%); border-radius: 50%; box-shadow: 0 0 120px #FFD700; animation: sunGlow 4s ease-in-out infinite; }
        @keyframes sunGlow { 0%, 100% { box-shadow: 0 0 120px #FFD700; } 50% { box-shadow: 0 0 180px #FFD700, 0 0 250px #FFA500; } }
        .garden-content { max-width: 950px; text-align: center; position: relative; z-index: 10; background: rgba(255, 255, 255, 0.96); padding: 70px; border-radius: 35px; box-shadow: 0 0 100px rgba(255, 215, 0, 1); border: 7px solid #FFD700; }
        .garden-title { font-family: 'Cinzel', serif; font-size: 52px; background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FFD700 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 35px; animation: titleShine 3s ease-in-out infinite; font-weight: 700; }
        @keyframes titleShine { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(1.4); } }
        .jesus-image { font-size: 130px; margin: 35px 0; filter: drop-shadow(0 0 40px rgba(255, 215, 0, 1)); animation: jesusGlow 2s ease-in-out infinite; }
        @keyframes jesusGlow { 0%, 100% { transform: scale(1); filter: drop-shadow(0 0 40px rgba(255, 215, 0, 1)); } 50% { transform: scale(1.12); filter: drop-shadow(0 0 70px rgba(255, 215, 0, 1)); } }
        .garden-text { font-size: 23px; line-height: 2; color: #2c1810; margin-bottom: 30px; text-align: justify; font-style: italic; }
        .garden-verse { font-size: 21px; color: #8B4513; margin: 35px 0; padding: 30px; background: rgba(255, 215, 0, 0.25); border-radius: 18px; border: 4px solid #FFD700; font-weight: 600; }
        .garden-buttons { display: flex; gap: 25px; justify-content: center; margin-top: 45px; }
        .enter-garden-btn { padding: 28px 70px; background: linear-gradient(180deg, #FFD700 0%, #FFA500 100%); border: 6px solid #8B6914; color: #000; font-family: 'Cinzel', serif; font-size: 22px; cursor: pointer; font-weight: 700; text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.5); box-shadow: 0 10px 0 #6B5410, 0 10px 40px rgba(255, 215, 0, 0.6); border-radius: 18px; transition: all 0.3s; text-transform: uppercase; }
        .enter-garden-btn:hover { background: linear-gradient(180deg, #FFEB3B 0%, #FFB300 100%); transform: translateY(-6px); box-shadow: 0 16px 0 #6B5410, 0 16px 50px rgba(255, 215, 0, 0.8); }
        .enter-garden-btn:active { transform: translateY(4px); box-shadow: 0 6px 0 #6B5410; }
        
        /* Paradise Scene - Final destination */
        #paradiseScene { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 50%, #90EE90 100%); display: none; align-items: center; justify-content: center; z-index: 2000; overflow: hidden; }
        #paradiseScene.active { display: flex; animation: paradiseFade 3s ease-out; }
        @keyframes paradiseFade { from { opacity: 0; } to { opacity: 1; } }
        .paradise-content { text-align: center; z-index: 10; background: rgba(255, 255, 255, 0.92); padding: 90px; border-radius: 45px; box-shadow: 0 0 120px rgba(255, 215, 0, 1); border: 9px solid #FFD700; max-width: 1050px; }
        .paradise-title { font-family: 'Cinzel', serif; font-size: 60px; background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FFD700 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 45px; animation: titleRainbow 3s ease-in-out infinite; font-weight: 700; }
        @keyframes titleRainbow { 0%, 100% { filter: hue-rotate(0deg) brightness(1.3); } 50% { filter: hue-rotate(25deg) brightness(1.6); } }
        .paradise-message { font-size: 26px; line-height: 2.1; color: #2c1810; margin-bottom: 45px; font-style: italic; }
        .paradise-blessing { font-family: 'Cinzel', serif; font-size: 30px; color: #8B4513; margin: 45px 0; padding: 35px; background: rgba(255, 215, 0, 0.35); border-radius: 23px; border: 5px solid #FFD700; font-weight: 700; }
        
        /* Prayer Text Display */
        #prayerTextDisplay { position: fixed; bottom: 240px; right: 20px; width: 370px; max-height: 420px; background: linear-gradient(135deg, rgba(0, 0, 0, 0.96), rgba(26, 26, 46, 0.96)); border: 4px solid #FFD700; border-radius: 18px; padding: 25px; box-shadow: 0 0 40px rgba(255, 215, 0, 0.7); display: none; z-index: 600; overflow-y: auto; }
        #prayerTextDisplay.active { display: block; animation: slideInRight 0.5s ease-out; }
        @keyframes slideInRight { from { transform: translateX(420px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .prayer-text-title { font-family: 'Cinzel', serif; font-size: 19px; color: #FFD700; margin-bottom: 18px; text-align: center; text-shadow: 2px 2px 0 #000; border-bottom: 3px solid #FFD700; padding-bottom: 12px; }
        .prayer-text-content { font-size: 15px; line-height: 1.9; color: #f0f0f0; text-align: justify; font-style: italic; }
        .close-prayer-text { margin-top: 18px; padding: 10px 25px; background: linear-gradient(180deg, #27ae60 0%, #1e8449 100%); border: 3px solid #FFD700; color: #fff; font-family: 'Cinzel', serif; font-size: 13px; cursor: pointer; border-radius: 8px; display: block; margin-left: auto; margin-right: auto; transition: all 0.2s; }
        .close-prayer-text:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(39, 174, 96, 0.6); }
        
        /* Prayer Selection Modal */
        #prayerSelection { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.92); display: none; align-items: center; justify-content: center; z-index: 1600; }
        #prayerSelection.active { display: flex; }
        .prayer-modal { background: linear-gradient(135deg, rgba(15, 12, 41, 0.98), rgba(48, 43, 99, 0.98)); border: 6px solid #FFD700; border-radius: 23px; padding: 45px; max-width: 650px; box-shadow: 0 0 60px rgba(255, 215, 0, 0.8); }
        .prayer-modal-title { font-family: 'Cinzel', serif; font-size: 30px; color: #FFD700; text-align: center; margin-bottom: 35px; text-shadow: 3px 3px 0 #000; }
        .prayer-options { display: grid; grid-template-columns: repeat(2, 1fr); gap: 18px; margin-bottom: 25px; }
        .prayer-option { padding: 23px; background: linear-gradient(180deg, #9b59b6 0%, #6c3483 100%); border: 4px solid #FFD700; border-radius: 12px; cursor: pointer; transition: all 0.2s; text-align: center; box-shadow: 0 5px 0 #4a235a; }
        .prayer-option:hover { transform: translateY(-4px); box-shadow: 0 9px 0 #4a235a, 0 9px 25px rgba(155, 89, 182, 0.6); }
        .prayer-option:active { transform: translateY(1px); box-shadow: 0 3px 0 #4a235a; }
        .prayer-icon { font-size: 45px; margin-bottom: 12px; }
        .prayer-name { font-family: 'Cinzel', serif; font-size: 15px; color: #fff; text-shadow: 2px 2px 0 #000; font-weight: 600; }
        .prayer-damage { font-size: 13px; color: #FFD700; margin-top: 7px; }
        
        /* Prayer Effects with enhanced visuals */
        .prayer-effect-cross { position: absolute; font-size: 70px; color: #FFD700; text-shadow: 0 0 30px #FFD700; animation: crossEffect 2s ease-out forwards; z-index: 50; pointer-events: none; }
        @keyframes crossEffect { 0% { transform: scale(0) rotate(0deg); opacity: 0; } 30% { opacity: 1; } 100% { transform: scale(3.5) rotate(720deg); opacity: 0; } }
        .prayer-effect-rose { position: absolute; font-size: 35px; animation: roseSpiral 2s ease-out forwards; z-index: 50; pointer-events: none; }
        @keyframes roseSpiral { 0% { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) rotate(720deg) scale(0.5); opacity: 0; } }
        .prayer-effect-glory { position: absolute; width: 12px; height: 12px; background: radial-gradient(circle, #fff, #FFD700); border-radius: 50%; animation: gloryBurst 1.5s ease-out forwards; z-index: 50; pointer-events: none; box-shadow: 0 0 25px #FFD700; }
        @keyframes gloryBurst { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; } }
        .prayer-effect-jesus { position: absolute; font-size: 55px; animation: jesusAscend 2.5s ease-out forwards; z-index: 50; pointer-events: none; text-shadow: 0 0 40px rgba(255, 215, 0, 0.9); }
        @keyframes jesusAscend { 0% { transform: translateY(110px) scale(0.5); opacity: 0; } 20% { opacity: 1; } 100% { transform: translateY(-220px) scale(1.6); opacity: 0; } }
        
        /* Intro Screen */
        #introScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); display: flex; align-items: center; justify-content: center; z-index: 2000; padding: 40px; }
        #introScreen.hidden { display: none; }
        .intro-content { max-width: 850px; text-align: center; background: rgba(0, 0, 0, 0.85); padding: 55px; border: 5px solid #FFD700; border-radius: 23px; box-shadow: 0 0 50px rgba(255, 215, 0, 0.6); }
        .intro-title { font-family: 'Cinzel', serif; font-size: clamp(30px, 5vw, 52px); color: #FFD700; margin-bottom: 35px; text-shadow: 4px 4px 0 #000; }
        .intro-text { font-size: clamp(15px, 2.5vw, 21px); line-height: 1.9; margin-bottom: 28px; color: #f0f0f0; text-align: justify; font-style: italic; }
        .intro-quote { font-size: clamp(17px, 2.8vw, 24px); color: #FFD700; margin: 35px 0; font-weight: 600; text-shadow: 2px 2px 0 #000; }
        .start-btn { padding: 23px 55px; background: linear-gradient(180deg, #FFD700 0%, #FFA500 100%); border: 5px solid #fff; color: #000; font-family: 'Cinzel', serif; font-size: clamp(17px, 3vw, 26px); cursor: pointer; font-weight: 700; text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.5); box-shadow: 0 8px 0 #8B6914; border-radius: 12px; transition: all 0.2s; margin-top: 25px; }
        .start-btn:hover { background: linear-gradient(180deg, #FFEB3B 0%, #FFB300 100%); transform: translateY(-4px); box-shadow: 0 12px 0 #8B6914; }
        .start-btn:active { transform: translateY(3px); box-shadow: 0 4px 0 #8B6914; }
        
        /* Game Container with enhanced visuals */
        #gameContainer { width: 100vw; height: 100vh; display: flex; flex-direction: column; position: relative; }
        #battleField { flex: 1; position: relative; display: flex; align-items: center; justify-content: space-between; padding: 55px; background: radial-gradient(ellipse at top, rgba(255, 215, 0, 0.18) 0%, transparent 50%), linear-gradient(180deg, #1a0033 0%, #0f001a 100%); overflow: hidden; }
        #battleField::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at 30% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(ellipse at 70% 50%, rgba(138, 43, 226, 0.1) 0%, transparent 50%); animation: backgroundPulse 4s ease-in-out infinite; pointer-events: none; }
        @keyframes backgroundPulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        .party-side { display: flex; flex-direction: column; gap: 35px; z-index: 10; }
        .enemy-side { display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        .character { position: relative; text-align: center; }
        .hero-sprite { font-size: 85px; animation: heroFloat 3s ease-in-out infinite; filter: drop-shadow(0 0 18px rgba(255, 215, 0, 0.7)); position: relative; }
        @keyframes heroFloat { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-12px); } }
        .hero-sprite::after { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 125%; height: 125%; background: radial-gradient(circle, rgba(255, 215, 0, 0.3) 0%, transparent 70%); border-radius: 50%; animation: heroAura 3s ease-in-out infinite; z-index: -1; }
        @keyframes heroAura { 0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; } 50% { transform: translate(-50%, -50%) scale(1.25); opacity: 1; } }
        .enemy-sprite { font-size: 110px; animation: enemyFloat 2s ease-in-out infinite; filter: drop-shadow(0 0 25px rgba(255, 0, 0, 0.8)); margin-bottom: 23px; position: relative; }
        @keyframes enemyFloat { 0%, 100% { transform: translateY(0px) rotate(-7deg); } 50% { transform: translateY(-14px) rotate(7deg); } }
        .enemy-sprite::after { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 135%; height: 135%; background: radial-gradient(circle, rgba(255, 0, 0, 0.4) 0%, transparent 70%); border-radius: 50%; animation: enemyAura 2s ease-in-out infinite; z-index: -1; }
        @keyframes enemyAura { 0%, 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 0.6; } 50% { transform: translate(-50%, -50%) scale(1.35) rotate(180deg); opacity: 1; } }
        .character-name { font-family: 'Cinzel', serif; font-size: 17px; margin-top: 17px; text-shadow: 2px 2px 0 #000, 0 0 15px #FFD700; color: #FFD700; font-weight: 700; }
        .sin-name { font-size: 26px; color: #ff4444; margin-bottom: 18px; text-transform: uppercase; letter-spacing: 3px; text-shadow: 2px 2px 0 #000, 0 0 20px #ff0000; }
        
        /* Enhanced HP bars */
        .hp-bar-container { width: 160px; height: 28px; background: #000; border: 4px solid #FFD700; margin: 12px auto; position: relative; box-shadow: 0 0 25px rgba(255, 215, 0, 0.5), inset 0 0 12px rgba(255, 215, 0, 0.25); border-radius: 6px; animation: borderGlow 2s ease-in-out infinite; }
        @keyframes borderGlow { 0%, 100% { box-shadow: 0 0 25px rgba(255, 215, 0, 0.5), inset 0 0 12px rgba(255, 215, 0, 0.25); } 50% { box-shadow: 0 0 35px rgba(255, 215, 0, 0.8), inset 0 0 18px rgba(255, 215, 0, 0.35); } }
        .hp-bar { height: 100%; background: linear-gradient(90deg, #00ff00 0%, #ffff00 50%, #ff0000 100%); transition: width 0.5s ease; box-shadow: inset 0 0 12px rgba(255, 255, 255, 0.35); border-radius: 4px; }
        .hp-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 13px; color: #fff; text-shadow: 1px 1px 0 #000; font-weight: bold; z-index: 1; font-family: 'Crimson Text', serif; }
        
        /* Damage numbers with enhanced effects */
        .damage-number { position: absolute; font-size: 36px; color: #ff0000; text-shadow: 4px 4px 0 #000, -1px -1px 0 #fff; animation: damageFloat 1.2s ease-out forwards; pointer-events: none; font-weight: bold; z-index: 100; font-family: 'Cinzel', serif; }
        @keyframes damageFloat { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-130px) scale(2); opacity: 0; } }
        .heal-number { color: #00ff00; }
        
        /* Menu Container */
        #menuContainer { height: 230px; background: rgba(0, 0, 0, 0.96); border-top: 5px solid #FFD700; display: flex; position: relative; box-shadow: 0 -6px 35px rgba(255, 215, 0, 0.4); }
        #battleLog { flex: 1; padding: 23px; overflow-y: auto; font-size: 15px; line-height: 2.1; border-right: 4px solid #FFD700; }
        .log-entry { margin: 10px 0; color: #fff; text-shadow: 1px 1px 0 #000; }
        .log-damage { color: #ff6b6b; font-weight: 600; }
        .log-prayer { color: #51cf66; font-style: italic; }
        .log-system { color: #ffd43b; font-weight: 600; }
        #actionMenu { width: 470px; padding: 23px; display: flex; flex-direction: column; gap: 17px; }
        .menu-section { display: flex; flex-direction: column; gap: 12px; }
        .menu-title { font-family: 'Cinzel', serif; font-size: 15px; color: #FFD700; text-shadow: 2px 2px 0 #000; margin-bottom: 7px; font-weight: 600; }
        .menu-buttons { display: grid; grid-template-columns: repeat(2, 1fr); gap: 14px; }
        .menu-btn { padding: 17px; background: linear-gradient(180deg, #4a90e2 0%, #2e5c8a 100%); border: 4px solid #FFD700; color: #fff; font-family: 'Cinzel', serif; font-size: 13px; cursor: pointer; text-shadow: 1px 1px 0 #000; transition: all 0.15s; box-shadow: 0 5px 0 #1a4d7a; border-radius: 6px; font-weight: 600; }
        .menu-btn:hover { background: linear-gradient(180deg, #5aa3ff 0%, #3d6fa3 100%); transform: translateY(-3px); box-shadow: 0 8px 0 #1a4d7a; }
        .menu-btn:active { transform: translateY(2px); box-shadow: 0 3px 0 #1a4d7a; }
        .menu-btn.prayer { background: linear-gradient(180deg, #9b59b6 0%, #6c3483 100%); box-shadow: 0 5px 0 #4a235a; }
        .menu-btn.prayer:hover { background: linear-gradient(180deg, #ae6bc7 0%, #7d3c98 100%); }
        
        /* Passage Overlay */
        #passageOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.96); display: none; align-items: center; justify-content: center; z-index: 1500; padding: 45px; }
        #passageOverlay.active { display: flex; }
        .passage-content { max-width: 750px; background: rgba(0, 0, 0, 0.92); padding: 55px; border: 6px solid #FFD700; border-radius: 23px; box-shadow: 0 0 60px rgba(255, 215, 0, 0.8); text-align: center; }
        .passage-title { font-family: 'Cinzel', serif; font-size: 30px; color: #FFD700; margin-bottom: 28px; text-shadow: 3px 3px 0 #000; }
        .passage-text { font-size: 19px; line-height: 1.9; color: #f0f0f0; margin-bottom: 33px; text-align: justify; font-style: italic; }
        .passage-reference { font-size: 15px; color: #FFD700; font-weight: 600; margin-bottom: 33px; }
        .continue-btn { padding: 20px 50px; background: linear-gradient(180deg, #27ae60 0%, #1e8449 100%); border: 5px solid #FFD700; color: #fff; font-family: 'Cinzel', serif; font-size: 17px; cursor: pointer; text-shadow: 2px 2px 0 #000; box-shadow: 0 8px 0 #145a32; border-radius: 12px; font-weight: 700; transition: all 0.2s; }
        .continue-btn:hover { background: linear-gradient(180deg, #2ecc71 0%, #229954 100%); transform: translateY(-3px); box-shadow: 0 11px 0 #145a32; }
        .continue-btn:active { transform: translateY(3px); box-shadow: 0 4px 0 #145a32; }
        
        /* Credits Screen */
        #creditsScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 45px; overflow-y: auto; }
        #creditsScreen.active { display: flex; }
        .credits-content { max-width: 950px; text-align: center; padding: 55px; }
        .credits-title { font-family: 'Cinzel', serif; font-size: 52px; color: #FFD700; margin-bottom: 55px; text-shadow: 5px 5px 0 #000; animation: titleGlow 2s ease-in-out infinite; }
        @keyframes titleGlow { 0%, 100% { text-shadow: 5px 5px 0 #000, 0 0 25px #FFD700; } 50% { text-shadow: 5px 5px 0 #000, 0 0 50px #FFD700; } }
        .credits-section { background: rgba(0, 0, 0, 0.75); padding: 35px; border: 4px solid #FFD700; border-radius: 18px; margin-bottom: 35px; box-shadow: 0 0 35px rgba(255, 215, 0, 0.5); }
        .credits-subtitle { font-family: 'Cinzel', serif; font-size: 26px; color: #FFD700; margin-bottom: 23px; font-weight: 600; }
        .credits-text { font-size: 19px; line-height: 2; color: #f0f0f0; text-align: justify; margin-bottom: 18px; font-style: italic; }
        
        /* Animation effects */
        .character.attacking { animation: attackMove 0.6s ease-in-out; }
        @keyframes attackMove { 0%, 100% { transform: translateX(0) scale(1); } 50% { transform: translateX(55px) scale(1.25); } }
        .character.damaged { animation: damageShake 0.5s ease-in-out; }
        @keyframes damageShake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-17px); } 75% { transform: translateX(17px); } }
        .prayer-animation { position: absolute; font-size: 55px; animation: prayerRise 1.5s ease-out forwards; z-index: 50; pointer-events: none; }
        @keyframes prayerRise { 0% { transform: translateY(0) scale(0.5); opacity: 0; } 30% { opacity: 1; } 100% { transform: translateY(-160px) scale(1.6); opacity: 0; } }
        
        /* Divine Light Effect */
        .divine-light { position: fixed; top: -100%; left: 50%; transform: translateX(-50%); width: 320px; height: 200%; background: linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.95) 10%, rgba(255, 215, 0, 0.75) 30%, rgba(255, 255, 255, 0.55) 50%, rgba(255, 255, 255, 0) 100%); pointer-events: none; z-index: 200; animation: divineDescend 2s ease-out forwards; filter: blur(22px); box-shadow: 0 0 110px rgba(255, 255, 255, 0.9); }
        @keyframes divineDescend { 0% { top: -100%; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
        
        /* Particle Effects */
        .particle { position: absolute; width: 9px; height: 9px; background: radial-gradient(circle, #FFD700 0%, transparent 70%); border-radius: 50%; pointer-events: none; animation: particleFloat 3s ease-out forwards; box-shadow: 0 0 12px #FFD700; }
        @keyframes particleFloat { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-320px) scale(0); opacity: 0; } }
        .victory-sparkle { position: absolute; width: 5px; height: 5px; background: #FFD700; border-radius: 50%; pointer-events: none; animation: sparkle 1.5s ease-out forwards; box-shadow: 0 0 12px #FFD700; }
        @keyframes sparkle { 0% { transform: translate(0, 0) scale(0); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(1); opacity: 0; } }
        .slash-effect { position: absolute; font-size: 85px; color: #FFD700; text-shadow: 0 0 25px #FFD700; animation: slashAnimation 0.6s ease-out forwards; pointer-events: none; z-index: 150; }
        @keyframes slashAnimation { 0% { transform: translateX(-110px) rotate(-45deg) scale(0.5); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateX(110px) rotate(45deg) scale(1.6); opacity: 0; } }
        
        /* Audio Controls */
        #audioControls { position: fixed; bottom: 240px; right: 23px; z-index: 500; background: rgba(0, 0, 0, 0.85); padding: 12px; border: 3px solid #FFD700; border-radius: 10px; display: flex; gap: 12px; }
        .audio-btn { background: linear-gradient(180deg, #FFD700 0%, #FFA500 100%); border: 3px solid #fff; color: #000; font-size: 22px; width: 44px; height: 44px; border-radius: 50%; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
        .audio-btn:hover { transform: scale(1.15); box-shadow: 0 0 18px #FFD700; }
        
        @media (max-width: 768px) {
            #battleField { padding: 23px; }
            .hero-sprite { font-size: 65px; }
            .enemy-sprite { font-size: 75px; }
            #actionMenu { width: 100%; }
            .menu-btn { font-size: 11px; padding: 13px; }
            .intro-content, .passage-content, .saint-content { padding: 33px; }
            .saint-image-container { width: 200px; height: 200px; }
        }
    </style>
</head>
<body>

    <!-- Intro Screen -->
    <div id="introScreen">
        <div class="intro-content">
            <div class="intro-title">‚õ™ BATTLE FOR VIRTUE ‚õ™</div>
            <div class="intro-text">
                "Man is divided in himself. As a result, the whole life of men, both individual and social, shows itself to be a struggle, and a dramatic one, between good and evil, between light and darkness."
            </div>
            <div class="intro-reference" style="font-size: 14px; color: #FFD700; margin-bottom: 25px;">
                ‚Äî Catechism of the Catholic Church, 409
            </div>
            <div class="intro-text">
                "The struggle against our inclinations toward evil is not easy; every man experiences it within himself. As a result, the entire life of man is a combat against the powers of darkness."
            </div>
            <div class="intro-quote">
                ‚úù IT'S UP TO YOU TO FIGHT FOR WHAT'S GOOD IN THE WORLD ‚úù
            </div>
            <button class="start-btn" onclick="startGame()">BEGIN YOUR JOURNEY</button>
        </div>
    </div>

    <!-- Game Container -->
    <div id="gameContainer">
        <div id="battleField">
            <div class="party-side">
                <div class="character" id="hero">
                    <div class="hero-sprite">
                        <div class="sprite sprite-guardian"></div>
                    </div>
                    <div class="character-name">GUARDIAN ANGEL</div>
                    <div class="hp-bar-container">
                        <div class="hp-bar" style="width: 100%"></div>
                        <div class="hp-text">777/777</div>
                    </div>
                </div>
                <div class="character" id="companion">
                    <div class="hero-sprite">
                        <div class="sprite sprite-angel"></div>
                    </div>
                    <div class="character-name">ST MICHAEL</div>
                    <div class="hp-bar-container">
                        <div class="hp-bar" style="width: 100%"></div>
                        <div class="hp-text">900/900</div>
                    </div>
                </div>
            </div>
            <div class="enemy-side" id="enemyContainer">
                <div class="sin-name" id="sinName">PRIDE</div>
                <div class="character enemy" id="currentEnemy">
                    <div class="enemy-sprite">
                        <div class="sprite sprite-enemy" id="enemySprite">üòà</div>
                    </div>
                    <div class="hp-bar-container">
                        <div class="hp-bar" style="width: 100%"></div>
                        <div class="hp-text">100/100</div>
                    </div>
                </div>
            </div>
        </div>
        <div id="audioControls">
            <button class="audio-btn" id="muteBtn" onclick="toggleMute()">üîä</button>
        </div>
        <div id="menuContainer">
            <div id="battleLog">
                <div class="log-entry log-system">‚öîÔ∏è The battle against sin begins! ‚öîÔ∏è</div>
            </div>
            <div id="actionMenu">
                <div class="menu-section">
                    <div class="menu-title">‚ñ∂ ACTIONS</div>
                    <div class="menu-buttons">
                        <button class="menu-btn" onclick="selectAction('attack')">‚öîÔ∏è STRIKE</button>
                        <button class="menu-btn prayer" onclick="selectAction('prayer')">üôè PRAYER</button>
                    </div>
                </div>
                <div class="menu-section">
                    <div class="menu-title">CURRENT SIN: <span id="currentSinDisplay">PRIDE</span></div>
                    <div style="font-size: 12px; color: #ccc;">Defeat all Seven Deadly Sins</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Prayer Selection Modal -->
    <div id="prayerSelection">
        <div class="prayer-modal">
            <div class="prayer-modal-title">‚úùÔ∏è SELECT YOUR PRAYER ‚úùÔ∏è</div>
            <div class="prayer-options" id="prayerOptions"></div>
        </div>
    </div>
    
    <!-- Prayer Text Display -->
    <div id="prayerTextDisplay">
        <div class="prayer-text-title" id="prayerTextTitle"></div>
        <div class="prayer-text-content" id="prayerTextContent"></div>
        <button class="close-prayer-text" onclick="closePrayerText()">AMEN</button>
    </div>

    <!-- Saint Modal -->
    <div id="saintModal">
        <div class="saint-content">
            <div class="saint-image-container">
                <div class="saint-halo"></div>
                <div class="saint-image" id="saintImage">üëº</div>
            </div>
            <div class="saint-title" id="saintName">Saint Name</div>
            <div class="saint-virtue" id="saintVirtue">Patron of Virtue</div>
            <div class="saint-quote" id="saintQuote"></div>
            <div class="saint-prayer" id="saintPrayer">Saint Name, pray for us!</div>
            <button class="continue-btn" onclick="closeSaintModal()">CONTINUE</button>
        </div>
    </div>

    <!-- Passage Overlay -->
    <div id="passageOverlay">
        <div class="passage-content">
            <div class="passage-title" id="passageTitle">Victory!</div>
            <div class="passage-text" id="passageText"></div>
            <div class="passage-reference" id="passageReference"></div>
            <button class="continue-btn" onclick="closePassage()">CONTINUE</button>
        </div>
    </div>

    <!-- Garden of Eden Modal -->
    <div id="gardenModal">
        <div class="garden-background"></div>
        <div class="garden-flowers" id="gardenFlowers"></div>
        <div class="paradise-sun"></div>
        <div class="garden-content">
            <div class="garden-title">üåü THE GATE OF PARADISE üåü</div>
            <div class="jesus-image">‚úùÔ∏è</div>
            <div class="garden-text">
                You have conquered the Seven Deadly Sins through prayer, faith, and virtue. Now, Jesus Christ Himself invites you to enter the Garden of Eden, where the faithful find eternal peace and communion with God.
            </div>
            <div class="garden-verse">
                "Come to me, all you who labor and are burdened, and I will give you rest." ‚Äî Matthew 11:28
            </div>
            <div class="garden-buttons">
                <button class="enter-garden-btn" onclick="enterParadise()">ENTER THE GARDEN</button>
            </div>
        </div>
    </div>

    <!-- Paradise Scene -->
    <div id="paradiseScene">
        <div class="paradise-sun"></div>
        <div class="paradise-content">
            <div class="paradise-title">üå∫ WELCOME TO PARADISE üå∫</div>
            <div class="paradise-message">
                You walk through the gates of the Garden of Eden. The air is filled with the fragrance of eternal flowers, and divine light surrounds you. Jesus Christ stands before you with open arms, welcoming you home.
            </div>
            <div class="jesus-image">üôè</div>
            <div class="paradise-blessing">
                "Well done, good and faithful servant. Enter into the joy of your Lord."<br>‚Äî Matthew 25:23
            </div>
            <div class="paradise-message">
                In this sacred place, free from sin and suffering, you find eternal rest in the presence of God. Your virtuous battle has earned you a place in Paradise.
            </div>
            <button class="continue-btn" style="margin-top: 40px;" onclick="location.reload()">BEGIN A NEW JOURNEY</button>
        </div>
    </div>

    <!-- Credits Screen -->
    <div id="creditsScreen">
        <div class="credits-content">
            <div class="credits-title">‚úù VICTORY OVER SIN ‚úù</div>
            <div class="credits-section">
                <div class="credits-subtitle">THE VIRTUES</div>
                <div class="credits-text">
                    "Human virtues are firm attitudes, stable dispositions, habitual perfections of intellect and will that govern our actions, order our passions, and guide our conduct according to reason and faith. They make possible ease, self-mastery, and joy in leading a morally good life."
                </div>
                <div class="passage-reference">‚Äî CCC 1804</div>
            </div>
            <div class="credits-section">
                <div class="credits-subtitle">CONSEQUENCES OF SIN</div>
                <div class="credits-text">
                    "Sin creates a proclivity to sin; it engenders vice by repetition of the same acts. This results in perverse inclinations which cloud conscience and corrupt the concrete judgment of good and evil. Thus sin tends to reproduce itself and reinforce itself, but it cannot destroy the moral sense at its root."
                </div>
                <div class="passage-reference">‚Äî CCC 1865</div>
            </div>
            <div class="credits-section">
                <div class="credits-subtitle">THE CALL TO HOLINESS</div>
                <div class="credits-text">
                    "All Christians in any state or walk of life are called to the fullness of Christian life and to the perfection of charity. All are called to holiness: 'Be perfect, as your heavenly Father is perfect.'"
                </div>
                <div class="passage-reference">‚Äî CCC 2013</div>
            </div>
            <div class="credits-section">
                <div class="credits-subtitle">GRACE AND JUSTIFICATION</div>
                <div class="credits-text">
                    "Grace is favor, the free and undeserved help that God gives us to respond to his call to become children of God, adoptive sons, partakers of the divine nature and of eternal life."
                </div>
                <div class="passage-reference">‚Äî CCC 1996</div>
            </div>
            <div style="margin-top: 50px;">
                <button class="continue-btn" onclick="location.reload()">PLAY AGAIN</button>
            </div>
        </div>
    </div>

    <script>
        // Audio System
        let audioContext, mainMelodyGain, victoryMelodyGain, isMuted = false;
        
        function initAudio() {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            mainMelodyGain = audioContext.createGain();
            mainMelodyGain.connect(audioContext.destination);
            mainMelodyGain.gain.value = 0.12;
            victoryMelodyGain = audioContext.createGain();
            victoryMelodyGain.connect(audioContext.destination);
            victoryMelodyGain.gain.value = 0.15;
        }
        
        function playPianoNote(frequency, startTime, duration, gainNode, velocity = 0.8) {
            const fundamental = audioContext.createOscillator();
            const harmonic2 = audioContext.createOscillator();
            const harmonic3 = audioContext.createOscillator();
            const noteGain = audioContext.createGain();
            const harm2Gain = audioContext.createGain();
            const harm3Gain = audioContext.createGain();
            
            fundamental.type = 'sine';
            fundamental.frequency.value = frequency;
            harmonic2.type = 'sine';
            harmonic2.frequency.value = frequency * 2;
            harmonic3.type = 'sine';
            harmonic3.frequency.value = frequency * 3;
            
            const maxVol = velocity * 0.3;
            noteGain.gain.setValueAtTime(0, startTime);
            noteGain.gain.linearRampToValueAtTime(maxVol, startTime + 0.01);
            noteGain.gain.exponentialRampToValueAtTime(maxVol * 0.7, startTime + 0.1);
            noteGain.gain.exponentialRampToValueAtTime(0.001, startTime + duration);
            
            harm2Gain.gain.value = 0.3;
            harm3Gain.gain.value = 0.15;
            
            fundamental.connect(noteGain);
            harmonic2.connect(harm2Gain);
            harmonic3.connect(harm3Gain);
            noteGain.connect(gainNode);
            harm2Gain.connect(gainNode);
            harm3Gain.connect(gainNode);
            
            fundamental.start(startTime);
            harmonic2.start(startTime);
            harmonic3.start(startTime);
            fundamental.stop(startTime + duration);
            harmonic2.stop(startTime + duration);
            harmonic3.stop(startTime + duration);
        }
        
        function playAveMaria() {
            if (!audioContext || isMuted) return;
            const now = audioContext.currentTime;
            const beat = 0.5;
            const melody = [
                { note: 'G4', duration: 1.5 }, { note: 'C5', duration: 0.5 }, { note: 'C5', duration: 1 },
                { note: 'D5', duration: 0.5 }, { note: 'C5', duration: 0.5 }, { note: 'B4', duration: 1 },
                { note: 'A4', duration: 1 }, { note: 'G4', duration: 2 }, { note: 'G4', duration: 1.5 },
                { note: 'E5', duration: 0.5 }, { note: 'E5', duration: 1 }, { note: 'F5', duration: 0.5 },
                { note: 'E5', duration: 0.5 }, { note: 'D5', duration: 1 }, { note: 'C5', duration: 1 },
                { note: 'G4', duration: 2 }, { note: 'C5', duration: 1.5 }, { note: 'E5', duration: 0.5 },
                { note: 'E5', duration: 1 }, { note: 'F5', duration: 0.5 }, { note: 'E5', duration: 0.5 },
                { note: 'D5', duration: 1 }, { note: 'C5', duration: 1 }, { note: 'B4', duration: 2 },
                { note: 'A4', duration: 1 }, { note: 'B4', duration: 0.5 }, { note: 'C5', duration: 0.5 },
                { note: 'D5', duration: 1.5 }, { note: 'C5', duration: 0.5 }, { note: 'B4', duration: 1 },
                { note: 'A4', duration: 1 }, { note: 'G4', duration: 3 }
            ];
            const noteFrequencies = {
                'C4': 261.63, 'D4': 293.66, 'E4': 329.63, 'F4': 349.23,
                'G4': 392.00, 'A4': 440.00, 'B4': 493.88,
                'C5': 523.25, 'D5': 587.33, 'E5': 659.25, 'F5': 698.46, 
                'G5': 783.99, 'A5': 880.00
            };
            let time = now + 0.1;
            melody.forEach(({ note, duration }) => {
                playPianoNote(noteFrequencies[note], time, duration * beat, mainMelodyGain);
                time += duration * beat;
            });
            setTimeout(() => playAveMaria(), (time - now) * 1000 + 1000);
        }
        
        function playChristBeOurLight() {
            if (!audioContext || isMuted) return;
            const now = audioContext.currentTime;
            const beat = 0.45;
            const melody = [
                { note: 'G4', duration: 1 }, { note: 'G4', duration: 1 }, { note: 'A4', duration: 0.5 },
                { note: 'B4', duration: 0.5 }, { note: 'C5', duration: 2 }, { note: 'B4', duration: 1 },
                { note: 'A4', duration: 1 }, { note: 'G4', duration: 1 }, { note: 'A4', duration: 1 },
                { note: 'B4', duration: 1 }, { note: 'C5', duration: 2 }, { note: 'G4', duration: 2 },
                { note: 'D5', duration: 1 }, { note: 'D5', duration: 1 }, { note: 'E5', duration: 0.5 },
                { note: 'D5', duration: 0.5 }, { note: 'C5', duration: 2 }, { note: 'B4', duration: 1 },
                { note: 'A4', duration: 1 }, { note: 'G4', duration: 1.5 }, { note: 'A4', duration: 0.5 },
                { note: 'B4', duration: 1 }, { note: 'C5', duration: 1 }, { note: 'D5', duration: 2 },
                { note: 'C5', duration: 2 }, { note: 'B4', duration: 1 }, { note: 'C5', duration: 1 },
                { note: 'D5', duration: 1 }, { note: 'E5', duration: 1.5 }, { note: 'D5', duration: 0.5 },
                { note: 'C5', duration: 3 }
            ];
            const noteFrequencies = {
                'C4': 261.63, 'D4': 293.66, 'E4': 329.63, 'F4': 349.23,
                'G4': 392.00, 'A4': 440.00, 'B4': 493.88,
                'C5': 523.25, 'D5': 587.33, 'E5': 659.25, 'F5': 698.46, 
                'G5': 783.99, 'A5': 880.00
            };
            let time = now + 0.1;
            melody.forEach(({ note, duration }) => {
                playPianoNote(noteFrequencies[note], time, duration * beat, victoryMelodyGain, 0.9);
                time += duration * beat;
            });
            setTimeout(() => playChristBeOurLight(), (time - now) * 1000 + 1500);
        }
        
        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteBtn').textContent = isMuted ? 'üîá' : 'üîä';
            mainMelodyGain.gain.value = isMuted ? 0 : 0.12;
            victoryMelodyGain.gain.value = isMuted ? 0 : 0.15;
        }
        
        // Visual Effects
        function createDivineLight(targetElement) {
            const light = document.createElement('div');
            light.className = 'divine-light';
            const rect = targetElement.getBoundingClientRect();
            light.style.left = (rect.left + rect.width / 2) + 'px';
            document.body.appendChild(light);
            setTimeout(() => light.remove(), 2000);
        }
        
        function createParticles(targetElement, count = 20) {
            const rect = targetElement.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                const angle = (Math.PI * 2 * i) / count;
                const velocity = 2 + Math.random() * 2;
                const tx = Math.cos(angle) * velocity * 50;
                const ty = Math.sin(angle) * velocity * 50;
                particle.style.left = centerX + 'px';
                particle.style.top = centerY + 'px';
                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                particle.style.animationDelay = (i * 0.02) + 's';
                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 3000);
            }
        }
        
        function createVictorySparkles(targetElement, count = 50) {
            const rect = targetElement.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'victory-sparkle';
                    const angle = Math.random() * Math.PI * 2;
                    const distance = Math.random() * 300;
                    const tx = Math.cos(angle) * distance;
                    const ty = Math.sin(angle) * distance;
                    sparkle.style.left = centerX + 'px';
                    sparkle.style.top = centerY + 'px';
                    sparkle.style.setProperty('--tx', tx + 'px');
                    sparkle.style.setProperty('--ty', ty + 'px');
                    document.body.appendChild(sparkle);
                    setTimeout(() => sparkle.remove(), 1500);
                }, i * 30);
            }
        }
        
        function createSlashEffect(targetElement) {
            const rect = targetElement.getBoundingClientRect();
            const slash = document.createElement('div');
            slash.className = 'slash-effect';
            slash.textContent = '‚öîÔ∏è';
            slash.style.left = rect.left + 'px';
            slash.style.top = (rect.top + rect.height / 2) + 'px';
            document.body.appendChild(slash);
            setTimeout(() => slash.remove(), 600);
        }
        
        // Game State with Saints data
        const game = {
            currentSinIndex: 0,
            currentTurn: 'player',
            heroes: [
                { id: 'hero', name: 'GUARDIAN ANGEL', hp: 777, maxHP: 777, attack: 25 },
                { id: 'companion', name: 'ST MICHAEL', hp: 900, maxHP: 900, attack: 20 }
            ],
            currentHeroIndex: 0,
            sins: [
                {
                    name: 'PRIDE', emoji: 'üòà', hp: 100, maxHP: 100, attack: 20,
                    passage: {
                        title: 'On Pride',
                        text: 'Pride is inordinate self-love which causes one to consider oneself superior to others and to hold others in contempt. It makes one refuse submission to God and even results in a person considering himself a god. Pride was the sin of Satan and our first parents. It is the beginning of every sin and the queen of vices.',
                        reference: 'CCC 1866, 2094'
                    },
                    saint: {
                        name: 'St. Francis of Assisi',
                        emoji: 'üïäÔ∏è',
                        virtue: 'Patron of Humility',
                        quote: 'Where there is charity and wisdom, there is neither fear nor ignorance. Where there is patience and humility, there is neither anger nor vexation. Where there is poverty and joy, there is neither greed nor avarice. Where there is peace and meditation, there is neither anxiety nor doubt.',
                        prayer: 'St. Francis of Assisi, pray for us!'
                    }
                },
                {
                    name: 'ENVY', emoji: 'üëø', hp: 100, maxHP: 100, attack: 18,
                    passage: {
                        title: 'On Envy',
                        text: 'Envy is sadness at the sight of another\'s goods and the immoderate desire to acquire them for oneself, even unjustly. When it wishes grave harm to a neighbor it is a mortal sin. Envy represents a form of sadness and therefore a refusal of charity; the baptized person should struggle against it by exercising good will.',
                        reference: 'CCC 2539, 2540'
                    },
                    saint: {
                        name: 'St. Thomas Aquinas',
                        emoji: 'üìñ',
                        virtue: 'Patron of Kindness and Charity',
                        quote: 'Charity is the form, mover, mother and root of all the virtues. The soul in charity moves all the other virtues to action. Envy is sorrow for another\'s good. A man ought to grieve over another\'s good, only if that good is an occasion of evil to himself.',
                        prayer: 'St. Thomas Aquinas, pray for us!'
                    }
                },
                {
                    name: 'WRATH', emoji: 'üò°', hp: 110, maxHP: 110, attack: 25,
                    passage: {
                        title: 'On Wrath',
                        text: 'Anger is a desire for revenge. To desire vengeance in order to do evil to someone who should be punished is illicit, but it is praiseworthy to impose restitution to correct vices and maintain justice. If anger reaches the point of a deliberate desire to kill or seriously wound a neighbor, it is gravely against charity; it is a mortal sin.',
                        reference: 'CCC 2302'
                    },
                    saint: {
                        name: 'St. John Vianney',
                        emoji: '‚õ™',
                        virtue: 'Patron of Patience',
                        quote: 'Private prayer is like straw scattered here and there: If you set it on fire it makes a lot of little flames. But gather these straws into a bundle and light them, and you get a mighty fire, rising like a column into the sky; public prayer is like that. When we have patience, we do not complain and we are not angry.',
                        prayer: 'St. John Vianney, pray for us!'
                    }
                },
                {
                    name: 'SLOTH', emoji: 'üò¥', hp: 90, maxHP: 90, attack: 15,
                    passage: {
                        title: 'On Sloth',
                        text: 'Acedia or spiritual sloth goes so far as to refuse the joy that comes from God and to be repelled by divine goodness. Sloth is a culpable lack of physical or spiritual effort. It refuses to consent to the obligation of participation in the love of God and neighbor.',
                        reference: 'CCC 2094, 2733'
                    },
                    saint: {
                        name: 'St. Th√©r√®se of Lisieux',
                        emoji: 'üåπ',
                        virtue: 'Patron of Diligence',
                        quote: 'Remember that nothing is small in the eyes of God. Do all that you do with love. Our Lord needs from us neither great deeds nor profound thoughts. Neither intelligence nor talents. He cherishes simplicity. Miss no single opportunity of making some small sacrifice, here by a smiling look, there by a kindly word; always doing the smallest right and doing it all for love.',
                        prayer: 'St. Th√©r√®se of Lisieux, pray for us!'
                    }
                },
                {
                    name: 'GREED', emoji: 'üí∞', hp: 100, maxHP: 100, attack: 22,
                    passage: {
                        title: 'On Greed',
                        text: 'Greed is a disordered desire for or inordinate attachment to material possessions and money. It is forbidden by the tenth commandment. The desire for the goods of another is immense, limitless, never satisfied. Greed is idolatry in that it makes money and possessions an ultimate end.',
                        reference: 'CCC 2536, 2551'
                    },
                    saint: {
                        name: 'St. Nicholas of Myra',
                        emoji: 'üéÅ',
                        virtue: 'Patron of Generosity',
                        quote: 'The giver of every good and perfect gift has called upon us to mimic His giving, by grace, through faith, and this is not of ourselves. In Christ we have been given every spiritual gift and blessing, and through the power of the Holy Spirit within us, we ought to give generously and cheerfully to those in need.',
                        prayer: 'St. Nicholas of Myra, pray for us!'
                    }
                },
                {
                    name: 'GLUTTONY', emoji: 'üçî', hp: 95, maxHP: 95, attack: 18,
                    passage: {
                        title: 'On Gluttony',
                        text: 'The virtue of temperance disposes us to avoid every kind of excess: the abuse of food, alcohol, tobacco, or medicine. Gluttony represents an inordinate desire to consume more than that which one requires. It is a sin against temperance and fails to respect the proper care of the body.',
                        reference: 'CCC 2290, 1809'
                    },
                    saint: {
                        name: 'St. Catherine of Siena',
                        emoji: '‚úùÔ∏è',
                        virtue: 'Patron of Temperance',
                        quote: 'We must not wish anything other than what happens from moment to moment, all the while, however, exercising ourselves in goodness. The virtue of temperance teaches us to desire what is reasonable and to restrain our appetite from excess. Be who God meant you to be and you will set the world on fire.',
                        prayer: 'St. Catherine of Siena, pray for us!'
                    }
                },
                {
                    name: 'LUST', emoji: 'üíã', hp: 100, maxHP: 100, attack: 20,
                    passage: {
                        title: 'On Lust',
                        text: 'Lust is disordered desire for or inordinate enjoyment of sexual pleasure. Sexual pleasure is morally disordered when sought for itself, isolated from its procreative and unitive purposes. The virtue of chastity comes under the cardinal virtue of temperance, which seeks to permeate the passions and appetites of the senses with reason.',
                        reference: 'CCC 2351, 1809'
                    },
                    saint: {
                        name: 'St. Maria Goretti',
                        emoji: 'ü§ç',
                        virtue: 'Patron of Chastity and Purity',
                        quote: 'What are you doing? Do not touch me! It is a sin! God does not want it! You will go to hell! Purity is a pearl so precious that those who possess it become like the angels of God in heaven. I forgive my murderer with all my heart, and I want him to be with me in Paradise.',
                        prayer: 'St. Maria Goretti, pray for us!'
                    }
                }
            ],
            prayers: [
                { 
                    name: 'OUR FATHER', icon: '‚úùÔ∏è', damage: 40,
                    text: 'Our Father, who art in heaven, hallowed be thy name; thy kingdom come; thy will be done on earth as it is in heaven. Give us this day our daily bread; and forgive us our trespasses as we forgive those who trespass against us; and lead us not into temptation, but deliver us from evil. Amen.',
                    used: false
                },
                { 
                    name: 'HAIL MARY', icon: 'üåπ', damage: 35,
                    text: 'Hail Mary, full of grace, the Lord is with thee; blessed art thou among women, and blessed is the fruit of thy womb, Jesus. Holy Mary, Mother of God, pray for us sinners, now and at the hour of our death. Amen.',
                    used: false
                },
                { 
                    name: 'GLORY BE', icon: '‚ú®', damage: 30,
                    text: 'Glory be to the Father, and to the Son, and to the Holy Spirit. As it was in the beginning, is now, and ever shall be, world without end. Amen.',
                    used: false
                },
                { 
                    name: 'JESUS PRAYER', icon: 'üôè', damage: 45,
                    text: 'Lord Jesus Christ, Son of God, have mercy on me, a sinner.',
                    used: false
                }
            ],
            waitingForAction: true
        };

        function startGame() {
            document.getElementById('introScreen').classList.add('hidden');
            initAudio();
            playAveMaria();
            loadCurrentSin();
        }

        function loadCurrentSin() {
            const sin = game.sins[game.currentSinIndex];
            document.getElementById('sinName').textContent = sin.name;
            document.getElementById('currentSinDisplay').textContent = sin.name;
            document.getElementById('enemySprite').textContent = sin.emoji;
            updateEnemyHealthBar();
            addBattleLog(`You face ${sin.name}! May God grant you strength!`, 'log-system');
        }

        function selectAction(action) {
            if (!game.waitingForAction) return;
            game.waitingForAction = false;
            const currentHero = game.heroes[game.currentHeroIndex];
            if (action === 'attack') {
                executeAttack(currentHero);
            } else if (action === 'prayer') {
                showPrayerMenu();
            }
        }

        function showPrayerMenu() {
            game.waitingForAction = true;
            const modal = document.getElementById('prayerSelection');
            const optionsContainer = document.getElementById('prayerOptions');
            optionsContainer.innerHTML = '';
            game.prayers.forEach((prayer, index) => {
                const option = document.createElement('div');
                option.className = 'prayer-option';
                option.innerHTML = `
                    <div class="prayer-icon">${prayer.icon}</div>
                    <div class="prayer-name">${prayer.name}</div>
                    <div class="prayer-damage">Holy Damage: ${prayer.damage}</div>
                `;
                option.onclick = () => selectPrayer(index);
                optionsContainer.appendChild(option);
            });
            modal.classList.add('active');
        }
        
        function selectPrayer(prayerIndex) {
            const prayer = game.prayers[prayerIndex];
            document.getElementById('prayerSelection').classList.remove('active');
            game.waitingForAction = false;
            if (!prayer.used) {
                showPrayerText(prayer);
                prayer.used = true;
            }
            executePrayer(game.heroes[game.currentHeroIndex], prayer);
        }
        
        function showPrayerText(prayer) {
            document.getElementById('prayerTextTitle').textContent = prayer.name;
            document.getElementById('prayerTextContent').textContent = prayer.text;
            document.getElementById('prayerTextDisplay').classList.add('active');
        }
        
        function closePrayerText() {
            document.getElementById('prayerTextDisplay').classList.remove('active');
        }

        function executeAttack(hero) {
            const sin = game.sins[game.currentSinIndex];
            const damage = Math.floor(hero.attack + Math.random() * 10);
            const heroEl = document.getElementById(hero.id);
            heroEl.classList.add('attacking');
            setTimeout(() => {
                heroEl.classList.remove('attacking');
                const enemyEl = document.getElementById('currentEnemy');
                createSlashEffect(enemyEl);
                createParticles(enemyEl, 15);
                applyDamageToEnemy(damage);
                addBattleLog(`${hero.name} strikes ${sin.name} for ${damage} damage!`, 'log-damage');
                checkBattleEnd();
            }, 300);
        }

        function executePrayer(hero, prayer) {
            const sin = game.sins[game.currentSinIndex];
            const heroEl = document.getElementById(hero.id);
            const enemyEl = document.getElementById('currentEnemy');
            heroEl.classList.add('attacking');
            createDivineLight(enemyEl);
            const rect = enemyEl.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            if (prayer.name === 'OUR FATHER') {
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const cross = document.createElement('div');
                        cross.className = 'prayer-effect-cross';
                        cross.textContent = '‚úùÔ∏è';
                        cross.style.left = centerX + 'px';
                        cross.style.top = centerY + 'px';
                        document.body.appendChild(cross);
                        setTimeout(() => cross.remove(), 2000);
                    }, i * 200);
                }
            } else if (prayer.name === 'HAIL MARY') {
                for (let i = 0; i < 12; i++) {
                    setTimeout(() => {
                        const rose = document.createElement('div');
                        rose.className = 'prayer-effect-rose';
                        rose.textContent = 'üåπ';
                        const angle = (i / 12) * Math.PI * 2;
                        const distance = 150;
                        rose.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
                        rose.style.setProperty('--ty', Math.sin(angle) * distance + 'px');
                        rose.style.left = centerX + 'px';
                        rose.style.top = centerY + 'px';
                        document.body.appendChild(rose);
                        setTimeout(() => rose.remove(), 2000);
                    }, i * 50);
                }
            } else if (prayer.name === 'GLORY BE') {
                for (let i = 0; i < 40; i++) {
                    setTimeout(() => {
                        const glory = document.createElement('div');
                        glory.className = 'prayer-effect-glory';
                        const angle = Math.random() * Math.PI * 2;
                        const distance = 100 + Math.random() * 150;
                        glory.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
                        glory.style.setProperty('--ty', Math.sin(angle) * distance + 'px');
                        glory.style.left = centerX + 'px';
                        glory.style.top = centerY + 'px';
                        document.body.appendChild(glory);
                        setTimeout(() => glory.remove(), 1500);
                    }, i * 20);
                }
            } else if (prayer.name === 'JESUS PRAYER') {
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        const jesus = document.createElement('div');
                        jesus.className = 'prayer-effect-jesus';
                        jesus.textContent = 'üôè';
                        jesus.style.left = (centerX - 40 + i * 20) + 'px';
                        jesus.style.top = (centerY + 50) + 'px';
                        document.body.appendChild(jesus);
                        setTimeout(() => jesus.remove(), 2500);
                    }, i * 150);
                }
            }
            
            const heroRect = heroEl.getBoundingClientRect();
            const prayerAnim = document.createElement('div');
            prayerAnim.className = 'prayer-animation';
            prayerAnim.textContent = prayer.icon;
            prayerAnim.style.left = heroRect.left + heroRect.width / 2 + 'px';
            prayerAnim.style.top = heroRect.top + 'px';
            document.body.appendChild(prayerAnim);
            setTimeout(() => prayerAnim.remove(), 1500);
            createParticles(heroEl, 25);
            
            setTimeout(() => {
                heroEl.classList.remove('attacking');
                createParticles(enemyEl, 30);
                applyDamageToEnemy(prayer.damage);
                addBattleLog(`${hero.name} prays ${prayer.name}! ${sin.name} takes ${prayer.damage} holy damage!`, 'log-prayer');
                checkBattleEnd();
            }, 800);
        }

        function applyDamageToEnemy(damage) {
            const sin = game.sins[game.currentSinIndex];
            sin.hp = Math.max(0, sin.hp - damage);
            const enemyEl = document.getElementById('currentEnemy');
            enemyEl.classList.add('damaged');
            setTimeout(() => enemyEl.classList.remove('damaged'), 500);
            updateEnemyHealthBar();
            showDamageNumber('currentEnemy', damage, false);
        }

        function updateEnemyHealthBar() {
            const sin = game.sins[game.currentSinIndex];
            const enemyEl = document.getElementById('currentEnemy');
            const hpBar = enemyEl.querySelector('.hp-bar');
            const hpText = enemyEl.querySelector('.hp-text');
            const percent = (sin.hp / sin.maxHP) * 100;
            hpBar.style.width = percent + '%';
            hpText.textContent = `${Math.floor(sin.hp)}/${sin.maxHP}`;
        }

        function updateHeroHealthBar(heroId) {
            const hero = game.heroes.find(h => h.id === heroId);
            const heroEl = document.getElementById(heroId);
            const hpBar = heroEl.querySelector('.hp-bar');
            const hpText = heroEl.querySelector('.hp-text');
            const percent = (hero.hp / hero.maxHP) * 100;
            hpBar.style.width = percent + '%';
            hpText.textContent = `${Math.floor(hero.hp)}/${hero.maxHP}`;
        }

        function showDamageNumber(targetId, amount, isHeal) {
            const targetEl = document.getElementById(targetId);
            const rect = targetEl.getBoundingClientRect();
            const damageNum = document.createElement('div');
            damageNum.className = 'damage-number' + (isHeal ? ' heal-number' : '');
            damageNum.textContent = (isHeal ? '+' : '-') + amount;
            damageNum.style.left = rect.left + rect.width / 2 + 'px';
            damageNum.style.top = rect.top + 'px';
            document.body.appendChild(damageNum);
            setTimeout(() => damageNum.remove(), 1200);
        }

        function checkBattleEnd() {
            const sin = game.sins[game.currentSinIndex];
            if (sin.hp <= 0) {
                const enemyEl = document.getElementById('currentEnemy');
                createVictorySparkles(enemyEl, 60);
                addBattleLog(`${sin.name} has been vanquished!`, 'log-system');
                showPassage(sin.passage);
                return;
            }
            setTimeout(() => enemyTurn(), 1000);
        }

        function enemyTurn() {
            const sin = game.sins[game.currentSinIndex];
            const target = game.heroes[Math.floor(Math.random() * game.heroes.length)];
            const damage = Math.floor(sin.attack + Math.random() * 8);
            target.hp = Math.max(0, target.hp - damage);
            const targetEl = document.getElementById(target.id);
            targetEl.classList.add('damaged');
            setTimeout(() => targetEl.classList.remove('damaged'), 500);
            updateHeroHealthBar(target.id);
            showDamageNumber(target.id, damage, false);
            addBattleLog(`${sin.name} attacks ${target.name} for ${damage} damage!`, 'log-damage');
            if (game.heroes.every(h => h.hp <= 0)) {
                setTimeout(() => {
                    alert('You have been defeated. But do not lose hope - try again!');
                    location.reload();
                }, 1000);
                return;
            }
            game.currentHeroIndex = (game.currentHeroIndex + 1) % game.heroes.length;
            game.waitingForAction = true;
        }

        function showPassage(passage) {
            document.getElementById('passageTitle').textContent = passage.title;
            document.getElementById('passageText').textContent = passage.text;
            document.getElementById('passageReference').textContent = passage.reference;
            document.getElementById('passageOverlay').classList.add('active');
        }

        function closePassage() {
            document.getElementById('passageOverlay').classList.remove('active');
            const sin = game.sins[game.currentSinIndex];
            showSaintModal(sin.saint);
        }

        function showSaintModal(saint) {
            document.getElementById('saintName').textContent = saint.name;
            document.getElementById('saintImage').textContent = saint.emoji;
            document.getElementById('saintVirtue').textContent = saint.virtue;
            document.getElementById('saintQuote').textContent = saint.quote;
            document.getElementById('saintPrayer').textContent = saint.prayer;
            document.getElementById('saintModal').classList.add('active');
        }

        function closeSaintModal() {
            document.getElementById('saintModal').classList.remove('active');
            game.currentSinIndex++;
            if (game.currentSinIndex >= game.sins.length) {
                showGardenOfEden();
            } else {
                loadCurrentSin();
                game.waitingForAction = true;
            }
        }

        function showGardenOfEden() {
            mainMelodyGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
            setTimeout(() => playChristBeOurLight(), 1000);
            
            const flowersContainer = document.getElementById('gardenFlowers');
            const flowers = ['üå∫', 'üå∏', 'üåº', 'üåª', 'üå∑', 'üåπ', 'üèµÔ∏è', 'üíê'];
            for (let i = 0; i < 35; i++) {
                const flower = document.createElement('div');
                flower.className = 'flower';
                flower.textContent = flowers[Math.floor(Math.random() * flowers.length)];
                flower.style.left = Math.random() * 100 + '%';
                flower.style.bottom = Math.random() * 40 + '%';
                flower.style.animationDelay = Math.random() * 3 + 's';
                flowersContainer.appendChild(flower);
            }
            
            document.getElementById('gardenModal').classList.add('active');
        }

        function enterParadise() {
            document.getElementById('gardenModal').classList.remove('active');
            document.getElementById('paradiseScene').classList.add('active');
        }

        function addBattleLog(message, className = '') {
            const log = document.getElementById('battleLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry ' + className;
            entry.textContent = message;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
    </script>
</body>
</html>
